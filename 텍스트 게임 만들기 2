#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define MAX_LEVEL 10

// 캐릭터 구조체
typedef struct {
    int level;
    int strength;    // 힘
    int agility;     // 민첩
    int intelligence; // 지능
    int luck;         // 행운
    int gold;         // 돈
    int experience;   // 경험치
} Character;

// 레벨업 함수
void levelUp(Character* character) {
    int statIncrease = 2;
    int statChoice = rand() % 4;  // 랜덤하게 두 개의 스탯을 선택
    int secondChoice;

    // 첫 번째 스탯 증가
    if (statChoice == 0) character->strength += statIncrease;
    else if (statChoice == 1) character->agility += statIncrease;
    else if (statChoice == 2) character->intelligence += statIncrease;
    else character->luck += statIncrease;

    // 두 번째 스탯 증가
    do {
        secondChoice = rand() % 4;
    } while (secondChoice == statChoice); // 중복된 스탯은 선택 안함

    if (secondChoice == 0) character->strength += statIncrease;
    else if (secondChoice == 1) character->agility += statIncrease;
    else if (secondChoice == 2) character->intelligence += statIncrease;
    else character->luck += statIncrease;
}

// 데미지 계산 함수
float calculateDamage(Character* character) {
    float damage = 1.0;
    damage *= (1 + 0.8 * character->strength);
    damage *= (1 + 0.6 * character->agility);
    damage *= (1 + 0.4 * character->intelligence);
    damage *= (1 + 1.0 * character->luck);
    return damage;
}

// 던전 보상 함수
void dungeonReward(Character* character) {
    int goldEarned = rand() % 100 + 50;  // 던전 클리어 시 금액 획득
    int expEarned = rand() % 20 + 10;   // 던전 클리어 시 경험치 획득

    character->gold += goldEarned;
    character->experience += expEarned;

    printf("You earned %d gold and %d experience points!\n", goldEarned, expEarned);
    printf("Total gold: %d, Total experience: %d\n", character->gold, character->experience);
}

int main() {
    srand(time(NULL));

    // 캐릭터 초기화
    Character player = {1, 5, 5, 5, 5, 0, 0};  // 초기 레벨, 스탯 설정

    printf("Character created! Starting the adventure...\n");

    // 던전 탐험 및 보상
    for (int i = 1; i <= 5; i++) {
        printf("\n--- Dungeon Level %d ---\n", i);
        dungeonReward(&player);

        if (player.experience >= 100) {
            player.level++;
            printf("\nLevel Up! New Level: %d\n", player.level);
            levelUp(&player);
            printf("Strength: %d, Agility: %d, Intelligence: %d, Luck: %d\n",
                player.strength, player.agility, player.intelligence, player.luck);
            player.experience = 0;  // 경험치 초기화
        }

        // 랜덤한 확률로 몬스터 등장
        if (rand() % 10 < 3) {  // 30% 확률로 강한 몬스터 등장
            printf("A stronger monster appears!\n");
        }
    }

    // 경험치 구매 선택
    printf("\nDo you want to buy experience with your gold? (1: Yes, 0: No): ");
    int choice;
    scanf("%d", &choice);
    if (choice == 1 && player.gold >= 50) {
        player.experience += 20;
        player.gold -= 50;
        printf("You bought 20 experience points!\n");
    }

    printf("\nAdventure completed. Final Stats:\n");
    printf("Level: %d\n", player.level);
    printf("Strength: %d, Agility: %d, Intelligence: %d, Luck: %d\n", 
        player.strength, player.agility, player.intelligence, player.luck);
    printf("Gold: %d, Experience: %d\n", player.gold, player.experience);

    return 0;
}
